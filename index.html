<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Christian N. Kerr</title>

<style>
:root{
  --bg:#bfbfbf; --panel:#b7b7b7; --paper:#fff; --paper2:#f7f7f7; --ink:#000;
  --hi:#fff; --deep:#000; --accent:#ff7a00;
  --mono: ui-monospace, Menlo, Monaco, Consolas, monospace;
  --rail:220px; --gap:12px; --btn:64px; --view:min(86vmin,720px);
  --stroke:2px; --pad:10px; --shadow:0 1px 0 rgba(0,0,0,.25);
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; font-family:var(--mono); color:var(--ink);
  background:
    repeating-linear-gradient(0deg,rgba(0,0,0,.22) 0 1px,transparent 1px 2px),
    repeating-linear-gradient(90deg,rgba(255,255,255,.18) 0 1px,transparent 1px 2px),
    repeating-linear-gradient(45deg,rgba(0,0,0,.12) 0 1px,transparent 1px 3px),
    var(--bg);
  overflow:hidden;
}

.frame{
  height:100svh;
  display:grid;
  grid-template-columns:var(--rail) 1fr;
  gap:18px;
  padding:
    calc(18px + env(safe-area-inset-top))
    calc(18px + env(safe-area-inset-right))
    calc(18px + env(safe-area-inset-bottom))
    calc(18px + env(safe-area-inset-left));
  align-items:start;
}

.win{
  background:var(--panel);
  padding:var(--pad);
  border:var(--stroke) solid;
  border-color:var(--hi) var(--deep) var(--deep) var(--hi);
  box-shadow:var(--shadow);
}
aside.win{position:sticky;top:18px}

.stage{
  height:100%;
  min-height:0;
  overflow:auto;
  overflow-x:hidden;
  scroll-behavior:smooth;
  overscroll-behavior:contain;
  -webkit-overflow-scrolling:touch;
}

/* panels */
.panel{display:none}
.panel.isActive{display:block}

/* home button */
.nameBtn{
  display:block; width:100%;
  text-align:center;
  font-weight:800; font-size:12px; letter-spacing:.08em;
  padding:8px;
  background:var(--paper);
  border:2px solid #000;
  cursor:pointer; user-select:none;
  margin-bottom:var(--gap);
  color:inherit;
  text-decoration:none;
}
.nameBtn.isActive{background:var(--accent)}

/* controls */
.controls{display:grid;justify-items:center;gap:var(--gap)}

/* compass */
.compass{
  width:var(--btn); height:var(--btn);
  background:#FFF3A0;
  border:2px solid #000;
  position:relative;
  display:flex;
  align-items:center;
  justify-content:center;
}
.compass svg{
  width:52px; height:52px;
  display:block;
  shape-rendering:crispEdges;
  image-rendering:pixelated;
}
.zones{
  position:absolute; inset:0;
  display:grid;
  grid-template:repeat(3,1fr)/repeat(3,1fr);
}
.zone{background:none;border:0;cursor:pointer}

/* nav buttons */
.btns{display:grid;grid-template-columns:var(--btn);gap:10px;justify-content:center}
.btn{
  width:var(--btn); height:var(--btn);
  display:grid; place-items:center;
  background:var(--paper2);
  border:2px solid;
  border-color:var(--hi) var(--deep) var(--deep) var(--hi);
  box-shadow:var(--shadow);
  cursor:pointer; user-select:none;
  color:inherit;
  text-decoration:none;
}
.btn:active{transform:translate(1px,1px)}
.glyph{font-size:32px;font-weight:900;line-height:1}
.btn.isActive{
  background:var(--accent);
  border-color:var(--deep) var(--hi) var(--hi) var(--deep);
}

/* clock button */
.clockBtn{
  width:100%;
  background:#cfe8ff; /* light blue */
  border:2px solid #000;
  padding:8px 10px;
  text-align:center;
  box-shadow:var(--shadow);
  cursor:pointer;
  user-select:none;
  font-family:inherit;
  color:#000;
}
.clockBtn:active{transform:translate(1px,1px)}
.clockLine{font-size:12px;font-weight:800;letter-spacing:.06em}

/* home viewport */
.wrap{width:var(--view);max-width:100%;margin:0}
.viewport{
  width:100%;
  aspect-ratio:1/1;
  overflow:scroll;
  border:2px solid #000;
  background:transparent;
  scrollbar-width:none;
  scroll-behavior:smooth;
  -webkit-overflow-scrolling: touch;
}
@media (min-width:1100px){
  #p-home .viewport{aspect-ratio:3 / 2;}
}
.viewport::-webkit-scrollbar{width:0;height:0}
.canvas{width:220%;height:220%;min-width:1100px;min-height:1100px;position:relative}
.canvas img{
  position:absolute; inset:0;
  width:100%; height:100%;
  object-fit:cover;
}
.overlayRow{margin-top:8px;display:flex;align-items:center;justify-content:flex-end;gap:10px}
.caption{
  max-width:360px;background:#fff;border:2px solid #000;
  padding:6px 8px;font-size:11px;line-height:1.2;
  white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
}
/* ===== caption slow scroll (only when overflowing) ===== */
.caption{ position:relative; }
.caption .capText{
  display:inline-block;
  white-space:nowrap;
  will-change: transform;
}

/* only animate when JS adds .isMarquee */
.caption.isMarquee .capText{
  padding-left: 100%;
  animation: capMarquee var(--capDur, 14s) linear infinite;
}

@keyframes capMarquee{
  from{ transform: translateX(0); }
  to{   transform: translateX(-100%); }
}

/* pause on hover/focus for readability */
.caption.isMarquee:hover .capText,
.caption.isMarquee:focus-within .capText{
  animation-play-state: paused;
}

/* respect reduced motion */
@media (prefers-reduced-motion: reduce){
  .caption.isMarquee .capText{ animation: none; padding-left:0; transform:none; }
}

.pager{display:flex;gap:6px}
.pbtn{
  width:34px;height:28px;display:grid;place-items:center;
  background:var(--paper2);
  border:2px solid;
  border-color:var(--hi) var(--deep) var(--deep) var(--hi);
  box-shadow:var(--shadow);
  cursor:pointer; user-select:none;
  color:#000;
  font-family:inherit;
}
.pbtn:active{transform:translate(1px,1px)}

/* list box */
.list{
  width:var(--view);max-width:100%;
  background:#fff;border:2px solid #000;
  padding:14px 14px 16px;
  font-size:13px;line-height:1.2;
  box-shadow:var(--shadow);
}
.list h2{margin:0 0 10px;font-size:14px;letter-spacing:.08em}
.rule{height:2px;background:#000;margin:10px 0 12px}
.spacer{height:14px}

/* terminal rows (no per-row scrolling) */
.items{margin-top:10px; width:max-content; min-width:100%}
.item{
  padding:6px 0;
  border-top:1px solid rgba(0,0,0,.14);
  font-variant-numeric: tabular-nums;
}
.item:first-child{border-top:0}
.pathRow{
  display:flex;
  align-items:baseline;
  gap:0;
  white-space:nowrap;
}
.prompt{opacity:.95}
.promptLine{display:flex;align-items:baseline;gap:0;white-space:nowrap}
.titleCell{white-space:nowrap}
.sep{opacity:.9; margin:0 4px;}
.metaLine{white-space:nowrap}

/* ONE scroller per page (moves headers + content together) */
.pageScroll{
  overflow-x:auto;
  overflow-y:hidden;
  scrollbar-width:none;
  -webkit-overflow-scrolling:touch;
}
.pageScroll::-webkit-scrollbar{width:0;height:0}
.pageInner{
  width:max-content;        /* make it scrollable horizontally when needed */
  min-width:100%;
}

/* links inside content */
.list a,
.caption a{
  color:#1f4f8a;
  text-decoration:none;
  -webkit-tap-highlight-color: transparent;
}
.list a:visited,
.caption a:visited{ color:#1f4f8a; }
.list a:focus,
.caption a:focus{
  outline:2px solid #000;
  outline-offset:2px;
}

em{font-style:italic}
.q{ quotes: "“" "”" "‘" "’"; }
.q::before{ content: open-quote; }
.q::after{ content: close-quote; }
.quote{margin-top:12px;font-size:12px;color:#444}

/* ===== MOBILE LAYOUT ===== */
@media (max-width:820px){
  :root{--rail:1fr;--btn:56px;--view:min(92vmin,720px)}
  .frame{ grid-template-columns:1fr !important; grid-template-rows:auto 1fr !important; }
  aside.win{ position:static !important; top:auto !important; }
  .controls{display:flex;align-items:center;justify-content:center;gap:12px;flex-wrap:wrap}
  .btns{grid-template-columns:repeat(3,var(--btn));gap:8px;justify-content:center}
  .clockBtn{flex-basis:100%}
  .list, .wrap{width:100%}
}
@media (max-width:420px){
  :root{--btn:48px}
  .glyph{font-size:28px}
  .caption{max-width:70%;font-size:10px}
}

/* ===== THOUGHTS modal ===== */
.modal{
  position:fixed; inset:0;
  display:none;
  padding:
    calc(18px + env(safe-area-inset-top))
    calc(18px + env(safe-area-inset-right))
    calc(18px + env(safe-area-inset-bottom))
    calc(18px + env(safe-area-inset-left));
  background:rgba(0,0,0,.28);
  z-index:999;
  align-items:center;
  justify-content:center;
}
.modal.isOpen{display:flex}
.modal .win{
  width:min(920px, 100%);
  background:#fff;
}
.modalHead{
  display:flex; align-items:center; justify-content:space-between;
  gap:10px;
  margin-bottom:10px;
}
.modalTitleWrap{
  display:flex; align-items:baseline; gap:10px;
  min-width:0;
}
.modalTitle{
  font-weight:900; letter-spacing:.08em; font-size:12px;
  white-space:nowrap;
}
.modalIdx{
  font-weight:900;
  font-size:12px;
  letter-spacing:.02em;
  opacity:.75;
  white-space:nowrap;
}
.modalNav{display:flex; gap:8px; align-items:center}
.navBtn,
.closeBtn{
  border:2px solid #000;
  background:var(--paper2);
  box-shadow:var(--shadow);
  cursor:pointer;
  padding:6px 10px;
  font-family:inherit;
  user-select:none;
  color:#000;
}
.navBtn{width:42px; text-align:center; padding:6px 0}
.navBtn:active,
.closeBtn:active{transform:translate(1px,1px)}
.quoteBox{
  border:2px solid #000;
  background:#fff;
  padding:12px 12px 10px;
  font-size:12px;
  line-height:1.25;
}
.qLine{white-space:pre-wrap; word-break:break-word;}
.qMeta{margin-top:8px; opacity:.65; white-space:pre-wrap;}
@media (max-width:520px){
  .modalTitleWrap{flex-direction:column; align-items:flex-start; gap:2px}
}
</style>
</head>

<body>
<div class="frame" id="root">
  <aside class="win" aria-label="Sidebar">
    <a class="nameBtn" id="linkHomeTop" href="/home" data-route="/home" title="Home" aria-label="Home">Christian N. Kerr</a>

    <div class="controls">
      <div class="compass" aria-label="D-pad">
        <svg viewBox="0 0 64 64" aria-hidden="true">
          <rect x="29" y="14" width="6" height="36" fill="#000"/>
          <rect x="14" y="29" width="36" height="6" fill="#000"/>
          <rect x="26" y="6" width="12" height="6" fill="#000"/>
          <rect x="23" y="12" width="18" height="6" fill="#000"/>
          <rect x="26" y="52" width="12" height="6" fill="#000"/>
          <rect x="23" y="46" width="18" height="6" fill="#000"/>
          <rect x="6" y="26" width="6" height="12" fill="#000"/>
          <rect x="12" y="23" width="6" height="18" fill="#000"/>
          <rect x="52" y="26" width="6" height="12" fill="#000"/>
          <rect x="46" y="23" width="6" height="18" fill="#000"/>
          <rect x="28" y="28" width="8" height="8" fill="#FFF3A0" stroke="#000" stroke-width="2"/>
        </svg>

        <div class="zones" id="zones">
          <button class="zone" data-pan="0,0"   aria-label="Northwest"></button>
          <button class="zone" data-pan=".5,0"  aria-label="North"></button>
          <button class="zone" data-pan="1,0"   aria-label="Northeast"></button>
          <button class="zone" data-pan="0,.5"  aria-label="West"></button>
          <button class="zone" data-pan=".5,.5" aria-label="Center"></button>
          <button class="zone" data-pan="1,.5"  aria-label="East"></button>
          <button class="zone" data-pan="0,1"   aria-label="Southwest"></button>
          <button class="zone" data-pan=".5,1"  aria-label="South"></button>
          <button class="zone" data-pan="1,1"   aria-label="Southeast"></button>
        </div>
      </div>

      <div class="btns" id="navBtns" aria-label="Navigation">
        <a class="btn" id="linkWriting"  href="/writing"  data-route="/writing"  title="Writing"  aria-label="Writing"><div class="glyph">写</div></a>
        <a class="btn" id="linkResearch" href="/research" data-route="/research" title="Research" aria-label="Research"><div class="glyph">研</div></a>
        <a class="btn" id="linkContact"  href="/contact"  data-route="/contact"  title="Contact"  aria-label="Contact"><div class="glyph">联</div></a>
      </div>

      <button class="clockBtn" id="clockBtn" type="button" aria-label="Current date and time (triple click for feed)">
        <div class="clockLine" id="clockStamp">—</div>
      </button>
    </div>
  </aside>

  <main class="stage" id="stage" aria-label="Stage">
    <section class="panel" id="p-home">
      <div class="win wrap" id="homeWrap">
        <div class="viewport" id="viewport">
          <div class="canvas" id="canvas">
            <img id="hero" src="market.jpg" alt="Snyders, The Market">
          </div>
        </div>

        <div class="overlayRow" id="homeOverlay" aria-label="Image controls">
          <div class="caption" id="caption">—</div>
          <div class="pager">
            <button class="pbtn" id="prev" type="button" aria-label="Previous image" title="Previous">◀</button>
            <button class="pbtn" id="next" type="button" aria-label="Next image" title="Next">▶</button>
          </div>
        </div>
      </div>
    </section>

    <section class="panel" id="p-writing">
      <div class="list">
        <div class="pageScroll" id="scroll-writing">
          <div class="pageInner">
            <h2>WRITING</h2>
            <div class="rule"></div>
            <div class="items" id="items-writing" aria-live="polite"></div>
          </div>
        </div>
      </div>
    </section>

    <section class="panel" id="p-research">
      <div class="list">
        <!-- ONE scroller for BOTH sections so they move together -->
        <div class="pageScroll" id="scroll-researchAll">
          <div class="pageInner">
            <h2>RESEARCH</h2>
            <div class="rule"></div>
            <div class="items" id="items-research" aria-live="polite"></div>

            <div class="spacer"></div>

            <h2>FACT-CHECKING</h2>
            <div class="rule"></div>
            <div class="items" id="items-factChecking" aria-live="polite"></div>
          </div>
        </div>
      </div>
    </section>

    <section class="panel" id="p-contact">
      <div class="list">
        <h2>CONTACT</h2>
        <div class="rule"></div>
        <p>
          Location: Brooklyn, New York, USA<br>
          Email: <a href="mailto:christian.n.kerr@gmail.com">christian.n.kerr@gmail.com</a><br>
          Socials:
          <a href="https://www.youtube.com/@CNKERR..." target="_blank" rel="noopener">YouTube</a>,
          <a href="https://x.com/cnkerr" target="_blank" rel="noopener">X</a>,
          <a href="https://www.instagram.com/cnkerr" target="_blank" rel="noopener">Instagram</a>
        </p>
        <p class="quote">
          "I celebrate myself, and sing myself, / And what I assume you shall assume, / For every atom belonging to me as good belongs to you." —WW
        </p>
      </div>
    </section>
  </main>
</div>

<!-- THOUGHTS modal -->
<div class="modal" id="thoughtsModal" aria-hidden="true">
  <div class="win">
    <div class="modalHead">
      <div class="modalTitleWrap">
        <div class="modalTitle" id="thoughtsTitle">THOUGHTS.ON.TIME</div>
        <div class="modalIdx" id="thoughtsIdx">000.000</div>
      </div>

      <div class="modalNav">
        <button class="navBtn" id="tqPrev" type="button" aria-label="Previous quote">◀</button>
        <button class="navBtn" id="tqNext" type="button" aria-label="Next quote">▶</button>
        <button class="closeBtn" id="closeThoughts" type="button" aria-label="Close">CLOSE</button>
      </div>
    </div>

    <div class="quoteBox" aria-live="polite">
      <div class="qLine" id="tqQuote">&gt; (add quote here)</div>
      <div class="qMeta" id="tqMeta">&gt;&gt; (work / author)</div>
    </div>
  </div>
</div>

<script>
(() => {
  const stage = document.getElementById("stage");

  const esc = (s) => String(s ?? "").replace(/[&<>"']/g, m => ({
    "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"
  }[m]));

  // Home pan
  const v = document.getElementById("viewport");
  const c = document.getElementById("canvas");
  const pan = (x,y) => v.scrollTo({
    left: (c.scrollWidth - v.clientWidth) * x,
    top:  (c.scrollHeight - v.clientHeight) * y,
    behavior: "smooth"
  });

  const scrollStage = (dir, fast=false) =>
    stage.scrollBy({ top: dir * (fast ? 380 : 160), behavior: "smooth" });

  // --- Home auto-fit sizing ---
  const homeWrap = document.getElementById("homeWrap");
  const homeOverlay = document.getElementById("homeOverlay");

  const fitHome = () => {
    if (!homeWrap || !homeOverlay || !v) return;
    if (!document.getElementById("p-home").classList.contains("isActive")) return;

    const stageW = stage.clientWidth;
    const stageH = stage.clientHeight;

    const overlayH = homeOverlay.offsetHeight || 0;
    const safety = 28;

    const maxByW = stageW - 6;
    const maxByH = stageH - overlayH - safety;

    const isWide = window.matchMedia("(min-width:1100px)").matches;
    const aspect = isWide ? (3/2) : 1;

    const isMobile = window.matchMedia("(max-width:820px)").matches;
    const chrome = 44;

    if (isMobile) {
      homeWrap.style.width = maxByW + "px";
      const viewportH = Math.max(220, Math.floor(maxByH - chrome));
      const side = Math.min(maxByW, viewportH);
      v.style.width = "100%";
      v.style.height = side + "px";
      return;
    }

    const height = Math.max(260, Math.floor(maxByH));
    let width = Math.floor(height * aspect);
    width = Math.min(width, maxByW);

    homeWrap.style.width = width + "px";
    v.style.width = "100%";
    v.style.height = Math.floor(width / aspect) + "px";
  };

  window.addEventListener("resize", () => requestAnimationFrame(fitHome), { passive:true });

// ===== Compass behavior (DETERMINISTIC) =====
const getActivePageScroller = () => {
  if (document.getElementById("p-writing").classList.contains("isActive")) {
    return document.getElementById("scroll-writing");
  }
  if (document.getElementById("p-research").classList.contains("isActive")) {
    return document.getElementById("scroll-researchAll");
  }
  return null;
};

document.getElementById("zones").addEventListener("click", (e) => {
  const b = e.target.closest("[data-pan]");
  if (!b) return;
  const [x,y] = b.dataset.pan.split(",").map(Number);

  const onHome = document.getElementById("p-home").classList.contains("isActive");
  if (onHome) return void pan(x,y);

  // LEFT/RIGHT => horizontal scroll the active page scroller
  const sc = getActivePageScroller();
  const dx = 260;
  if (sc && x < 0.5) return void sc.scrollBy({ left: -dx, behavior: "smooth" });
  if (sc && x > 0.5) return void sc.scrollBy({ left:  dx, behavior: "smooth" });

  // CENTER => top
  if (x === 0.5 && y === 0.5) return void stage.scrollTo({ top: 0, behavior: "smooth" });

  // UP/DOWN => stage scroll
  if (y < 0.5) return void scrollStage(-1, y === 0);
  if (y > 0.5) return void scrollStage( 1, y === 1);
});


  // Slideshow
  const img = document.getElementById("hero");
  const cap = document.getElementById("caption");
  const slides = [
    { src: "market.jpg", alt: 'Snyders, "Market Scene"' },
    { src: "flowers.jpg", alt: 'Bruegel the Younger, "Basket of Flowers"' },
    { src: "conjurer.jpg", alt: 'H. Bosch, "The Conjurer"' },
    { src: "icarus.jpg",   alt: 'Bruegel the Elder, "Landscape w/ the Fall..."' }
  ];
  let slideIndex = Number(localStorage.getItem("slideIndex") || 0) || 0;

  const showSlide = (n) => {
    slideIndex = (n + slides.length) % slides.length;
    img.src = slides[slideIndex].src;
    img.alt = slides[slideIndex].alt || "";
    const text = slides[slideIndex].alt || "";
cap.innerHTML = `<span class="capText">${esc(text)}</span>`;
cap.classList.remove("isMarquee");

// turn on marquee only if it overflows
requestAnimationFrame(() => {
  const span = cap.querySelector(".capText");
  if (!span) return;

  // measure overflow
  const overflow = span.scrollWidth > cap.clientWidth + 2;
  if (!overflow) return;

  // optional: set duration based on text length (simple + deterministic)
  const dur = Math.min(28, Math.max(10, Math.ceil(span.scrollWidth / 30)));
  cap.style.setProperty("--capDur", dur + "s");
  cap.classList.add("isMarquee");
});

    localStorage.setItem("slideIndex", String(slideIndex));
    requestAnimationFrame(() => pan(.5,.5));
  };

  document.getElementById("prev").addEventListener("click", () => showSlide(slideIndex - 1));
  document.getElementById("next").addEventListener("click", () => showSlide(slideIndex + 1));
  window.addEventListener("keydown", (e) => {
    if (e.key === "ArrowLeft") showSlide(slideIndex - 1);
    if (e.key === "ArrowRight") showSlide(slideIndex + 1);
  });

  // Clock (America/New_York)
  const clockStamp = document.getElementById("clockStamp");
  const tick = () => {
    const now = new Date();
    const parts = new Intl.DateTimeFormat("en-US", {
      timeZone: "America/New_York",
      year: "numeric", month: "2-digit", day: "2-digit",
      hour: "2-digit", minute: "2-digit", second: "2-digit",
      hour12: false
    }).formatToParts(now);
    const get = (t) => parts.find(p => p.type === t)?.value || "00";
    clockStamp.textContent =
      `${get("year")}.${get("month")}.${get("day")}T${get("hour")}:${get("minute")}:${get("second")}:ET`;
  };
  tick();
  setInterval(tick, 1000);

  /* =========================
     *** DATA GOES HERE ***
     Paste your: const DATA = { writing:[...], research:[...], factChecking:[...], timeQuotes:[...] };
     directly below this comment (replace the placeholder object).
  ========================= */
    // Data
  const DATA = {
    writing: [
      { title:"Taryn Simon Mines the Empty Aesthetics of Diplomacy", outlet:"Hyperallergic", year:2016, url:"http://hyperallergic.com/282066/taryn-simon-mines-the-empty-aesthetics-of-diplomacy/" },
      { title:"Rolling Through Barbara Kruger's Slick Skatepark Installation", outlet:"Hyperallergic", year:2017, url:"https://hyperallergic.com/410095/barbara-kruger-les-coleman-skatepark-performa/" },
      { title:"The Power of Protest Art and the Dignity of the Protester", outlet:"Hyperallergic", year:2017, url:"https://hyperallergic.com/the-power-of-protest-art-and-the-dignity-of-the-protester/" },
      { title:"A Collaborative Reading of 'Song of Myself'", outlet:"Hyperallergic", year:2017, url:"https://hyperallergic.com/373782/a-collaborative-reading-of-whitmans-song-of-myself-all-across-alabama/" },
      { title:"Imagining a Sustainable Skateboard", outlet:"Village Psychic", year:2022, url:"https://www.villagepsychic.net/blog/imagining-a-sustainable-skateboard?rq=kerr" },
      { title:"Climate Change: the Ultimate Skatestopper", outlet:"Village Psychic", year:2020, url:"https://www.villagepsychic.net/blog//climate-change-the-ultimate-skatestopper" },
      { title:"Considering the Ideal Skate Outfit", outlet:"Village Psychic", year:2020, url:"https://www.villagepsychic.net/blog/what-is-the-ultimate-skate-silhouette" },
      { title:"The Activists of Crimson Tide Country", outlet:"The New Yorker", year:2016, url:"http://www.newyorker.com/news/sporting-scene/the-activists-of-crimson-tide-country" },
      { title:"Best of 2021: Trung, 'RESPECTFULLY'", outlet:"Quartersnacks", year:2021, url:"https://quartersnacks.com/2021/12/the-best-skate-videos-parts-of-2021-qs-readers-poll-results/" },
      { title:"Best of 2022: Tyshawn, 'The General'", outlet:"Quartersnacks", year:2022, url:"https://quartersnacks.com/2022/12/the-best-skate-videos-parts-of-2022-qs-readers-poll-results/" },
      { title:"Best of 2023: Shanahan, 'Double-Up'", outlet:"Quartersnacks", year:2023, url:"https://quartersnacks.com/2023/12/the-best-skate-videos-parts-of-2023-qs-readers-poll-results/" },
      { title:"Best of 2024: Deedz, 'Uneven'", outlet:"Quartersnacks", year:2024, url:"https://quartersnacks.com/2024/12/the-best-skate-videos-parts-of-2024-qs-readers-poll-results/" },
      { title:"Best of 2025: Gustav, '3:2'", outlet:"Quartersnacks", year:2025, url:"https://quartersnacks.com/2025/12/the-best-skate-videos-parts-of-2025-qs-readers-poll-results/" },
      { title:"Waxing Poetic #1: 'Prufrock'", outlet:"Simple Magic", year:2025, url:"https://www.simplemagic.ca/waxing-poetic-1-the-love-song-of-j-alfred-prufrock/" },
      { title:"Waxing Poetic #2: 'Slam, Dunk & Hook'", outlet:"Simple Magic", year:2025, url:"https://www.simplemagic.ca/waxing-poetic-2-slam-dunk-hook/" },
      { title:"Waxing Poetic #3: 'The Second Coming'", outlet:"Simple Magic", year:2025, url:"https://www.simplemagic.ca/waxing-poetic-3-the-second-coming/" },
      { title:"Mark Ronson&Lucky Daye for Audemars Piguet", outlet:"Complex", year:2022, url:"https://www.complex.com/style/a/christiannkerr/mark-ronson-lucky-daye-new-song-too-much-audemars-piguet" },
      { title:"China's Li-Ning Wants Erik Ellington's Help", outlet:"Complex", year:2021, url:"https://www.complex.com/sneakers/a/christiankerr/li-ning-erik-ellington-signature-model-skateboard-collection" },
      { title:"How Ebonie Ward Manages Future", outlet:"Complex", year:2020, url:"https://www.complex.com/music/a/christiannkerr/how-ebonie-ward-built-her-team" },
      { title:"Can Fashion Subvert the Surveillance State?", outlet:"Secret Mag", year:2021, url:"https://secretmag.net/2021/11/10/surveillance-fashion-metaverse/" },
      { title:"A Chat w/ Andrew Considine, WKND Pro", outlet:"Free Skate Mag", year:2022, url:"https://www.freeskatemag.com/2022/01/19/wknds-street-fighters-ii-andrew-considine-interview/" },
      { title:"Meet the YouTube Stars Disrupting Skateboarding", outlet:"Jenkem Mag", year:2015, url:"https://www.jenkemmag.com/home/2015/04/24/meet-the-youtube-stars-that-are-disrupting-skateboarding/" },
      { title:"Remembering David Bowie Through Skate Videos", outlet:"Jenkem Mag", year:2016, url:"https://www.jenkemmag.com/home/2016/01/11/remembering-david-bowie-through-skate-videos/" },
      { title:"Talking to a Professional Fingerboarder", outlet:"Jenkem Mag", year:2015, url:"https://www.jenkemmag.com/home/2015/12/14/an-interview-with-a-professional-fingerboarder/" },
      { title:"Finding the Guy Who Tried the 13-Flat-13 in the Rain", outlet:"Jenkem Mag", year:2015, url:"https://www.jenkemmag.com/home/2015/09/02/an-interview-with-the-guy-who-tried-the-13-flat-13-in-the-rain/" },
      { title:"4 Skateboarding Events the Olympics Can Have", outlet:"Jenkem Mag", year:2015, url:"https://www.jenkemmag.com/home/2015/08/04/4-skateboarding-events-the-olympics-can-have/" },
      { title:"Meet Neftalie, US Ambassador of Skateboarding", outlet:"Jenkem Mag", year:2017, url:"https://www.jenkemmag.com/home/2017/03/01/americas-ambassador-of-skateboarding-neftalie-williams/" },
      { title:"The Skateboarder's Guide to the 2016 Presidential Election", outlet:"Jenkem Mag", year:2016, url:"https://www.jenkemmag.com/home/2016/04/18/the-skateboarders-guide-to-the-2016-u-s-presidential-election/" },
      { title:"The Death & Life of the Great American Skate Plaza", outlet:"Jenkem Mag", year:2016, url:"https://www.jenkemmag.com/home/2016/03/11/the-death-and-life-of-great-american-skate-plazas/" },
      { title:"7 Tricks to Make You Look Better at Skating Than You Really Are", outlet:"Jenkem Mag", year:2020, url:"https://www.jenkemmag.com/home/2020/09/10/7-tricks-make-look-better-at-skating-than-you-really-are/" },
      { title:"A Skater's Guide to Attending a Protest", outlet:"Jenkem Mag", year:2020, url:"https://www.jenkemmag.com/home/2020/06/04/skaters-guide-attending-protest/" },
      { title:"Is it Safe to Skate in the Time of Coronavirus?", outlet:"Jenkem Mag", year:2020, url:"https://www.jenkemmag.com/home/2020/03/17/safe-skate-time-coronavirus/" },
      { title:"Appreciating the Latino Immigrants that Shaped Skateboarding", outlet:"Jenkem Mag", year:2019, url:"https://www.jenkemmag.com/home/2019/08/09/appreciating-latinx-immigrants-shaped-skateboarding/" },
 { title:"An American in Anshan, China", outlet:"Tumblr", year:2013, url:"https://www.tumblr.com/american-in-anshan-blog/" }
    ],
    research: [
      { title:"House of Gates", outlet:"Nicholas Kulish (FSG)", year:2026, url:"https://www.nytimes.com/by/nicholas-kulish", italic:true },
      { title:"“The Betrayal”", outlet:"George Packer (The Atlantic)", year:2022, url:"https://www.theatlantic.com/magazine/archive/2022/03/biden-afghanistan-exit-american-allies-abandoned/621307/" },
      { title:"Truly Like Lightning", outlet:"David Duchovny (FSG)", year:2018, url:"https://us.macmillan.com/books/9781250791108/trulylikelightning/", italic:true },
      { title:"Our Man", outlet:"George Packer (Knopf)", year:2018, url:"https://www.penguinrandomhouse.com/books/215731/our-man-by-george-packer/", italic:true }
    ],
    factChecking: [
      { title:"The Magic Mountain Saved My Life", author:"George Packer", publication:"The Atlantic", date:"Dec 2024", url:"https://www.theatlantic.com/magazine/archive/2024/12/thomas-mann-magic-mountain-cultural-political-relevance/680400/" },
      { title:"No One Gave a Speech Like Patrick Henry", author:"Drew Gilpin Faust", publication:"The Atlantic", date:"Nov 2025", url:"https://www.theatlantic.com/magazine/archive/2025/11/patrick-henry-revolutionary-orator/684308/" },
      { title:"The Many Lives of Eliza Schuyler", author:"Jane Kamensky", publication:"The Atlantic", date:"Nov 2025", url:"https://www.theatlantic.com/magazine/archive/2025/11/american-revolution-women-eliza-schuyler-abigail-adams/684331/" },
      { title:"The Judgments of Muriel Spark", author:"Judith Shulevitz", publication:"The Atlantic", date:"Sep 2025", url:"https://www.theatlantic.com/magazine/archive/2025/09/muriel-spark-religion-writing/683550/" },
      { title:"The Insurrection Problem", author:"Jeffrey Rosen", publication:"The Atlantic", date:"Nov 2025", url:"https://www.theatlantic.com/magazine/archive/2025/11/shays-rebellion-hamilton-jefferson-political-ideologies/684319/" },
      { title:"What I Learned from Sammy Davis Jr.", author:"Questlove", publication:"The Atlantic", date:"Dec 2025", url:"https://www.theatlantic.com/magazine/2025/12/questlove-sammy-davis-jr-career/684605/" }
    ],

     /* THOUGHTS.ON.TIME feed (fill these in) */
    timeQuotes: [
      { quote:"When the shadow of the sash appeared on the curtains it was between seven and eight oclock and then I was in time again, hearing the watch. It was Grandfather’s and when Father gave it to me he said, Quentin, I give you the mausoleum of all hope and desire; it’s rather excrutiatingly apt that you will use it to gain the reducto absurdum of all human experience which can fit your individual needs no better than it fitted his or his father’s. I give it to you not that you may remember time, but that you might forget it now and then for a moment and not spend all your breath trying to conquer it. Because no battle is ever won he said. They are not even fought. The field only reveals to man his own folly and despair, and victory is an illusion of philosophers and fools.", work:"The Sound and the Fury", author:"Faulkner" },
      { quote:"Yet the timeless in you is aware of life’s timelessness, / And knows that yesterday is but today’s memory and tomorrow is today’s dream. / And that that which sings and contemplates in you is still dwelling within the bounds of that first moment which scattered the stars into space. / Who among you does not feel that his power to love is boundless?", work:"The Prophet", author:"Khalil Gibran" },      
      { quote:"Thus the whirligig of time brings in his revenges.", work:"Twelfth Night", author:"Shakespeare" },
   { quote:"Thus we play the fools with the time, and the spirits of the wise sit in the clouds and mock us.", work:"King Henry IV", author:"Shakespeare" },  
{ quote:"The Moving Finger writes; and, having writ, Moves on: nor all thy Piety nor Wit shall lure it back to cancel half a Line, Nor all thy Tears wash out a Word of it.", work:"Rubáiyát", author:"Omar Khayyám" },
      { quote:"It ain't no time, it ain't no time, it ain't no time. (Ain't no time.)", work:"Ain't No Time", author:"Future" },
{ quote:"You can be sure / Some go low to get high / You may hurt 'til you cry / You may die (You may die) / Keep on trying (Keep on trying) / 'Til it's summer, in the city / 'Til it's summer, in the city.", work:"You May Die", author:"Outkast" },
{ quote:"Modernity is the transient, the fleeting, the contingent; it is one half of art, the other being the-eternal and the immovable.", work:"The Painter of Modern Life", author:"Baudelaire" },
{ quote:"For, lo! the winter is past, the rain is over and gone; the flowers appear on the earth; the time of the singing of birds is come, and the voice of the turtle is heard in our land.", work:"The Song of Solomon", author:"the Bible" },      
{ quote:"Millions of spiritual creatures walk the earth / Unseen, both when we wake and when we sleep.", work:"Paradise Lost", author:"Milton" },
{ quote:"There is a time for some things, and a time for all things; a time for great things, and a time for small things.)", work:"Don Quixote", author:"Cervantes" },
    ]
  };

  // Helpers used by render()
  const parseMonthYear = (s) => {
    const str = String(s || "").trim();
    const m = str.match(/^([A-Za-z]{3,})\s+(\d{4})$/);
    if (!m) return 0;
    const month = m[1].slice(0,3).toLowerCase();
    const year = Number(m[2]);
    const months = {jan:0,feb:1,mar:2,apr:3,may:4,jun:5,jul:6,aug:7,sep:8,oct:9,nov:10,dec:11};
    if (!(month in months) || !Number.isFinite(year)) return 0;
    return new Date(year, months[month], 1).getTime();
  };

  const authorPublisherHtml = (s) => {
    const str = String(s || "").trim();
    const m = str.match(/^(.*)\s+\(([^)]+)\)\s*$/);
    if (!m) return esc(str);
    const author = esc(m[1].trim());
    const pub = esc(m[2].trim());
    return `${author} (<em>${pub}</em>)`;
  };

  const row1 = ({ titleHtml, metaHtml }) => `
    <div class="item">
      <div class="pathRow">
        <div class="promptLine">
          <span class="prompt">&gt;</span>
          <span class="titleCell">${titleHtml}</span>
        </div>
        ${metaHtml ? `<span class="sep"> / </span><span class="metaLine">${metaHtml}</span>` : ``}
      </div>
    </div>
  `;

  const render = (section) => {
    const out = document.getElementById(`items-${section}`);
    if (!out) return;

    const items = (DATA[section] || []).slice().sort((a,b) => {
      if (section === "factChecking") return parseMonthYear(b.date) - parseMonthYear(a.date);
      return (b.year ?? 0) - (a.year ?? 0);
    });

    if (!items.length){
      out.innerHTML = row1({ titleHtml:"No items yet.", metaHtml:"" });
      return;
    }

    if (section === "writing"){
      out.innerHTML = items.map(it => {
        const title = esc(it.title || "");
        const href = it.url ? String(it.url) : "";
        const titleHtml = href
          ? `<a href="${esc(href)}" target="_blank" rel="noopener">${title}</a>`
          : title;

        const pub = it.outlet ? `<em>${esc(it.outlet)}</em>` : "";
        const year = it.year ? esc(it.year) : "";
        const metaHtml = [pub, year].filter(Boolean).join(" / ");
        return row1({ titleHtml, metaHtml });
      }).join("");
      return;
    }

    if (section === "research"){
      out.innerHTML = items.map(it => {
        const raw = esc(it.title || "");
        const inner = it.italic ? `<em>${raw}</em>` : raw;
        const href = it.url ? String(it.url) : "";
        const titleHtml = href
          ? `<a href="${esc(href)}" target="_blank" rel="noopener">${inner}</a>`
          : inner;

        const ap = it.outlet ? authorPublisherHtml(it.outlet) : "";
        const year = it.year ? esc(it.year) : "";
        const metaHtml = [ap, year].filter(Boolean).join(" / ");
        return row1({ titleHtml, metaHtml });
      }).join("");
      return;
    }

    // factChecking
    out.innerHTML = items.map(it => {
      const titleQuoted = `<span class="q">${esc(it.title || "")}</span>`;
      const href = it.url ? String(it.url) : "";
      const titleHtml = href
        ? `<a href="${esc(href)}" target="_blank" rel="noopener">${titleQuoted}</a>`
        : titleQuoted;

      const author = esc(it.author || "");
      const pub = it.publication ? `<em>${esc(it.publication)}</em>` : "";
      const ap = author && pub ? `${author} (${pub})` : (author || (pub ? `(${pub})` : ""));
      const date = esc(it.date || "");
      const metaHtml = [ap, date].filter(Boolean).join(" / ");
      return row1({ titleHtml, metaHtml });
    }).join("");
  };

  // Router
  const panels = {
    home: document.getElementById("p-home"),
    writing: document.getElementById("p-writing"),
    research: document.getElementById("p-research"),
    contact: document.getElementById("p-contact"),
  };

  const links = {
    home: document.getElementById("linkHomeTop"),
    writing: document.getElementById("linkWriting"),
    research: document.getElementById("linkResearch"),
    contact: document.getElementById("linkContact"),
  };

  const normalizePath = (p) => {
    const path = (p || "/").split("?")[0].split("#")[0];
    if (path === "/" || path === "/home") return "/home";
    if (path === "/writing") return "/writing";
    if (path === "/research") return "/research";
    if (path === "/contact") return "/contact";
    return "/home";
  };

  const pathToKey = (path) => normalizePath(path).replace("/","");

  const setActive = (key) => {
    Object.entries(panels).forEach(([k,el]) => el.classList.toggle("isActive", k === key));
    Object.entries(links).forEach(([k,el]) => el.classList.toggle("isActive", k === key));
    stage.scrollTo({ top: 0, behavior: "auto" });
    if (key === "home") requestAnimationFrame(() => { fitHome(); pan(.5,.5); });
  };

  const navigate = (path, {replace=false} = {}) => {
    const key = pathToKey(path);
    const finalPath = "/" + key;
    if (replace) history.replaceState({key}, "", finalPath);
    else history.pushState({key}, "", finalPath);
    setActive(key);
  };

  document.addEventListener("click", (e) => {
    const a = e.target.closest("a[data-route]");
    if (!a) return;
    const href = a.getAttribute("href") || "/home";
    if (href.startsWith("http")) return;
    e.preventDefault();
    navigate(href);
  });

  window.addEventListener("popstate", () => setActive(pathToKey(location.pathname)));

  const params = new URLSearchParams(location.search);
  const p = params.get("p");
  if (p) history.replaceState({}, "", normalizePath(p));

  if (location.pathname === "/") navigate("/home", { replace:true });
  else setActive(pathToKey(location.pathname));

  /* ===== THOUGHTS modal ===== */
  const modal = document.getElementById("thoughtsModal");
  const closeThoughts = document.getElementById("closeThoughts");
  const clockBtn = document.getElementById("clockBtn");

  const tqQuote = document.getElementById("tqQuote");
  const tqMeta  = document.getElementById("tqMeta");
  const tqPrev  = document.getElementById("tqPrev");
  const tqNext  = document.getElementById("tqNext");
  const tqIdx   = document.getElementById("thoughtsIdx");

  const pad3 = (n) => String(n).padStart(3, "0");
  const fmtIdx = (i, total) => `${pad3(i)}.${pad3(total)}`;

  let qi = Number(localStorage.getItem("timeQuoteIndex") || 0) || 0;

  const renderQuote = () => {
    const quotes = Array.isArray(DATA.timeQuotes) ? DATA.timeQuotes : [];
    const total = quotes.length;

    if (!total){
      tqQuote.textContent = "> (add quote here)";
      tqMeta.textContent  = ">> (work / author)";
      tqIdx.textContent   = fmtIdx(0, 0);
      return;
    }

    qi = ((qi % total) + total) % total;
    const q = quotes[qi] || {};
    const text = String(q.quote || "").trim();
    const work = String(q.work || "").trim();
    const author = String(q.author || "").trim();

    tqQuote.textContent = `> ${text || "(add quote here)"}`;

    const metaParts = [];
    if (work) metaParts.push(work);
    if (author) metaParts.push(author);
    tqMeta.textContent = `>> ${metaParts.join(" / ") || "(work / author)"}`;

    tqIdx.textContent = fmtIdx(qi + 1, total);
    localStorage.setItem("timeQuoteIndex", String(qi));
  };

  const openModal = () => {
    renderQuote();
    modal.classList.add("isOpen");
    modal.setAttribute("aria-hidden", "false");
  };
  const closeModal = () => {
    modal.classList.remove("isOpen");
    modal.setAttribute("aria-hidden", "true");
  };
  const isOpen = () => modal.classList.contains("isOpen");

  const prevQuote = () => { qi -= 1; renderQuote(); };
  const nextQuote = () => { qi += 1; renderQuote(); };

  tqPrev.addEventListener("click", prevQuote);
  tqNext.addEventListener("click", nextQuote);
  closeThoughts.addEventListener("click", closeModal);
  modal.addEventListener("click", (e) => { if (e.target === modal) closeModal(); });

  window.addEventListener("keydown", (e) => {
    if (!isOpen()) return;
    if (e.key === "Escape") closeModal();
    if (e.key === "ArrowLeft") prevQuote();
    if (e.key === "ArrowRight") nextQuote();
  });

  // triple-click on clock
  let clickCount = 0;
  let clickTimer = null;
  const CLICK_WINDOW_MS = 650;

  clockBtn.addEventListener("click", () => {
    clickCount += 1;
    clearTimeout(clickTimer);
    clickTimer = setTimeout(() => { clickCount = 0; }, CLICK_WINDOW_MS);
    if (clickCount >= 3){
      clickCount = 0;
      openModal();
    }
  });

  window.addEventListener("load", () => {
    showSlide(slideIndex);
    render("writing");
    render("research");
    render("factChecking");
    requestAnimationFrame(() => { fitHome(); pan(.5,.5); });
  });
})();
</script>
</body>
</html>
